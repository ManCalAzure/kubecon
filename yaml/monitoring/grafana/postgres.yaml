# # monitoring/grafana/postgres.yaml
# apiVersion: apps/v1
# kind: StatefulSet
# metadata:
#   name: postgres
#   namespace: grafana
# spec:
#   serviceName: postgres
#   replicas: 1   # For true HA, replace with an HA Postgres operator/managed DB
#   selector:
#     matchLabels: { app: postgres }
#   template:
#     metadata:
#       labels: { app: postgres }
#     spec:
#       containers:
#         - name: postgres
#           image: postgres:16
#           imagePullPolicy: IfNotPresent
#           env:
#             - name: POSTGRES_PASSWORD
#               valueFrom: { secretKeyRef: { name: grafana-secrets, key: POSTGRES_PASSWORD } }
#             - name: POSTGRES_USER
#               valueFrom: { secretKeyRef: { name: grafana-secrets, key: POSTGRES_USER } }
#             - name: POSTGRES_DB
#               valueFrom: { secretKeyRef: { name: grafana-secrets, key: POSTGRES_DB } }
#           ports:
#             - name: tcp
#               containerPort: 5432
#           volumeMounts:
#             - name: data
#               mountPath: /var/lib/postgresql/data
#           resources:
#             requests:
#               cpu: 100m
#               memory: 256Mi
#   volumeClaimTemplates:
#     - metadata:
#         name: data
#       spec:
#         accessModes: ["ReadWriteOnce"]
#         resources:
#           requests:
#             storage: 10Gi
#         # storageClassName: longhorn  # <-- Uncomment/adjust if needed
# ---
# apiVersion: v1
# kind: Service
# metadata:
#   name: postgres
#   namespace: grafana
# spec:
#   selector: { app: postgres }
#   ports:
#     - name: pg
#       port: 5432
#       targetPort: 5432
